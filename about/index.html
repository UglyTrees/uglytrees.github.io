<html>

	<!--
	
	MIT License

	Copyright (c) 2019 UglyTrees

	Permission is hereby granted, free of charge, to any person obtaining a copy
	of this software and associated documentation files (the "Software"), to deal
	in the Software without restriction, including without limitation the rights
	to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
	copies of the Software, and to permit persons to whom the Software is
	furnished to do so, subject to the following conditions:

	The above copyright notice and this permission notice shall be included in all
	copies or substantial portions of the Software.

	THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
	IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
	FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
	AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
	LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
	OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
	SOFTWARE.

	-->

	<head>
		<title>About UglyTrees</title>
		
		<meta charset="UTF-8">
		<meta name="description" content="A browser-based multispecies coalescent tree visualiser">
		<meta name="keywords" content="phylogenetics,bayesian,multispecies,coalescent,tree,uglytrees,javascript,svg">
		<meta name="author" content="Jordan Douglas">
		<meta name="viewport" content="width=1200">
		
		<link rel="icon" href="../images/uglytreeslogo.png">
		<link rel="stylesheet" href="../src/styles.css">

		
	<script type="text/x-mathjax-config">
	  MathJax.Hub.Config({
	    tex2jax: {
	      inlineMath: [ ['$','$'], ["\\(","\\)"] ],
	      processEscapes: true
	    }
	  });
	</script>
		<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
		<script language='JavaScript' type='text/JavaScript' src="https://ajax.googleapis.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
		<script>


			function init(){


			}
			


		</script>

		<script async src="https://www.googletagmanager.com/gtag/js?id=UA-106202043-2"></script>
		
		<script>
			window.dataLayer = window.dataLayer || [];
			function gtag(){dataLayer.push(arguments);}
			gtag('js', new Date());

			gtag('config', 'UA-106202043-2');
		</script>


	</head>
	<body  onload="init()">


		<div id="innerBody">


			<div id="header">

				
			
					<ul class="flex-container thicklines" style="font-size:20%;">
				
						<li class="flex-item" style="width:30%">
						
							<div class="topbuttondiv">
		
							</div>
						
						</li>
						
						<li class="flex-item mainheader">
							UglyTrees
							<div class="subheader">A multispecies coalescent visualiser </div>	
						</li>
						
						
						<li class="flex-item" style="width:30%">
							<div class="topbuttondiv">
								<div class="textbutton right selected" title="Tutorials and guides"><a>About</a></div>
								<div class="textbutton right" title="Use UglyTrees"><a href="../">UglyTrees</a></div>
							</div>
						</li>
						

					</ul>
				
				
			</div>



			<div id="main">


				<div class="outersection">


					<div class="aboutsection">

						<h1>UglyTrees Guide</h1>

						<div>
								
							UglyTrees (UT) is a browser-based multispecies coalescent tree visualiser. This tutorial details some of its basic and advanced features. <br>
							<b>Author:</b> Jordan Douglas, School of Computer Science, University of Auckland

							<!--
							<h3>The multispecies coalescent model</h3>

							In phylogenetics, shared evolutionary history inferred from the genetic sequences of related individuals.  The multispecies coalescent (MSC) is a 
						-->

						</div>





						<div class="aboutsection inner" id="webscraping">

							<h2>1) Getting started</h2>

							<div>
								
								<div style="line-height: 2em">
									Upload a species tree file and optionally one or more gene tree files. These should be specified in <a href="https://en.wikipedia.org/wiki/Newick_format">Newick</a> or <a href="https://en.wikipedia.org/wiki/Nexus_file">NEXUS</a> format. For some examples, see the main page <a href="http://www.uglytrees.nz">uglytrees.nz</a>. When ready, press <span id="renderTreesBtn"  class="button">Draw trees</span> to begin! <br><br>


									UT requires that the species and gene trees are rooted binary trees. The height of a node is assumed to be its time $t$ (with the present day $t=0$ nodes being at the bottom of the graph). In a conventional multispecies coalescent depiction, the x-axis corresponds to effective population sizes in the species tree. 

								</div>

									<div class="aboutsection inner">

										<h3>1.1) Navigation</h3>

										<div>


											A multispecies coalescent model can be complicated, especially for large trees or multiple gene trees. Navigation through the model is easier with the arrow keys! <br> <br>
											
												<div style="text-align:center">
													<img src="../images/arrows.png" style="width:10em;"/>
												</div><br> 

											If there is more than one species/gene state uploaded (eg. a posterior distribution), the horizontal arrows (hotkeys: &larr; and &rarr;) navigate through the states, while the double horizontal arrows (hotkeys: ctrl + &larr; and ctrl + &rarr;) skip forward many states. The play button will animate through the list of states. <br><br>


											If there is more than one gene tree, the vertical arrows (hotkeys: &uarr; and &darr;) cycle through the list of gene trees. It is also possible to display more than one gene tree at a time using the <span class="mockMenuBtn">Gene trees</span> menu at the top. However, this may not look good for a large number of gene trees! <br><br>


											By mouse-scrolling (or pinching if mobile) and mouse-dragging (or panning if mobile), the graph can be zoomed in on and further navigated. <br><br>



											Alternatively, to focus on an area consider adjusting the x-axis and y-axis ranges (located in the <span class="mockMenuBtn">View</span> top menu). 

							
											

										</div>



									</div>



									<div class="aboutsection inner">

										<h3>1.2) Downloading the figure</h3>

										<div>
											The figure can be downloaded as an SVG by opening the <span class="mockMenuBtn">Save As</span> dialog at the top of the main page.   <br> <br>

										</div>

									</div>



									<div class="aboutsection inner">

										<h3>1.3) Configuring visual settings </h3>

										<div>

											


											Use the <span class="mockMenuBtn">View</span> top menu to configure axis and annotation settings:




											<div style="text-align:center">
													<img src="../images/annotations.png" style="width:18em;"/>
													<img src="../images/annotations2.png" style="width:18em;"/>
												</div><br> 

											 <b>Annotations</b> are read in from the input tree files and are automatically classified as numerical or discrete. Numerical settings are associated 2 colours: 
											 a palette min and a palette max. These default to the colour-blind friendly purple/yellow palette. Whereas, each value of a discrete annotation receives its own colour.     <br> <br>



											 Use the <span class="mockMenuBtn">Species tree</span> and <span class="mockMenuBtn">Gene trees</span> top menus to configure visual settings of the respective trees. Shape sizes, line widths, and colourings can be set manually, or automatically set to the value of a meta-annotation. For example, the width of a line in the species tree could be proportional to the substitution rate of that branch under a clock model. Or, the colour of a gene tree leaf could be associated with some observed trait (eye colour: discrete; body mass: numeric; etc.) of the individual.     <br> <br>


											

										</div>

									</div>




							</div>



						</div>







						<div class="aboutsection inner" id="webscraping">

							<h2>2) Web scraping</h2>

							<div>
								
								Any changes made to the visual settings of UT can be downloaded as a template (in .xml format). To do this, select
								<span class="mockMenuBtn">Save As</span> from the main program. The settings can be restored by uploading the template from the <span class="mockMenuBtn">Open</span> menu. <br><br>

								Alternatively, UT can load a template file by scraping the web if the location of the template is provided in the URL. This is achieved two 
								ways: by using either the 'w' (web) or the 'g' (GitHub) URL parameter. 

									<div class="aboutsection inner">

										<h3>2.1) General case (w)</h3>

										<div>
											Use the following URL: 
											<div class="code">
												www.uglytrees.nz/?<b style="color:#DB5079;">w</b>=http://website.com/template.xml
											</div>
											where <span class="code">http://website.com/template.xml</span> is a web-location of an UT template.
											

										</div>



										<h3>2.2) GitHub (g)</h3>

										<div>
											Use the following URL: 
											<div class="code">
												www.uglytrees.nz/?<b style="color:#DB5079;">g</b>=OWNER/REPO/PATH/TO/template.xml
											</div>
											where <span class="code">OWNER</span> is the owner of the GitHub repository  <span class="code">REPO</span>
											and  <span class="code">PATH/TO/template.xml</span> is the path to the UglyTrees template from the
											master branch root. Due to restrictions in the GitHub API, files larger than 1MB may not be retrieved.
											For large files, the <b style="color:#DB5079;">w</b> parameterisation should be used.
											

										</div>

									</div>


									This enables the sharing of multispecies coalescent visualisations with just one click.
									The 'trees' section of the template file looks like the following:


									<div class="code">
										&lt;trees&gt; <br>
											&nbsp;&nbsp; &lt;species filename="species.trees" /&gt; <br>
											&nbsp;&nbsp; &lt;gene filename="../trees/gene1.trees" /&gt; <br>
											&nbsp;&nbsp; &lt;gene filename="http://www.uglytrees.nz/trees/gene2.trees" /&gt; <br>
										&lt;/trees&gt;
									</div>


									In this example, one species and two gene tree files will be loaded into UT.
									The second gene tree is scraped directly from the specified URL (http/https must be specified),
									whereas, the species tree and the other gene are scraped from the relative directory (relative to
									the template file specified by <b style="color:#DB5079;">w</b> or <b style="color:#DB5079;">g</b>).  
									However, due to security restrictions imposed by the web browser, if the template.xml file is uploaded
									directly from local storage, relative tree files are ignored. 


									<div class="aboutsection inner">

										<h3>2.3) Examples</h3>

										<div>

											<a href="http://uglytrees.nz/?w=http://uglytrees.nz/examples/gopher/session.xml">
												http://www.uglytrees.nz/?<b>w</b>=http://uglytrees.nz/examples/gopher/session.xml

											</a> <br><br>

											<a href="http://www.uglytrees.nz/?g=uglytrees/uglytrees.github.io/examples/simulated/session.xml">
												http://www.uglytrees.nz/?<b>g</b>=uglytrees/uglytrees.github.io/examples/simulated/session.xml
											</a>

										</div>

									</div>
									



							</div>



						</div>












						<div class="aboutsection inner" id="mapping">

							<h2>3) Species to gene node mapping</h2>

							<div>
								In order to embed one (or more) gene trees inside a species tree, a mapping function between species leaves and gene leaves is required.
								This function is automatically detected by UT by comparing species and gene leaf labels. The mapping algorithm attempts to map each gene leaf 								to exactly one species. This is achieved by substring comparison, and if that fails, the labels are
								split using a range of delimiters (<span class="code">_</span>, <span class="code">-</span>, and <span class="code">.</span>). If a mapping cannot
								be found, the user is notified. Consider the following (simulated) nexus files:


								
								<div class="code">
									<b>species.nexus:</b><br>
									#NEXUS<br><br>

									Begin taxa;<br>
										&nbsp;&nbsp; Dimensions ntax=4;<br>
											&nbsp;&nbsp; &nbsp;&nbsp; Taxlabels<br>
												&nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; horse<br>
												&nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; seahorse<br>
												&nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; cat<br>
												&nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; catfish<br>
												&nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; ;<br>
									End;<br>
									Begin trees;<br>
										&nbsp;&nbsp; Translate<br>
											 &nbsp;&nbsp; &nbsp;&nbsp;   1 horse,<br>
											 &nbsp;&nbsp; &nbsp;&nbsp;   2 seahorse,<br>
											 &nbsp;&nbsp; &nbsp;&nbsp;   3 cat,<br>
											 &nbsp;&nbsp; &nbsp;&nbsp;   4 catfish<br>
									;<br>
									tree STATE_0 = (((1[&pop=2.6]:0.03225324288335552,4[&pop=1]:0.03225324288335552)[&pop=3]:0.43392160615904984,3[&pop=1.2]:0.46617484904240536)[&pop=0.5]:0.3061633578277898,2[&pop=0.5]:0.7723382068701952)[&pop=0.5];
								</div>



								<div class="code">
									<b>gene1.nexus:</b><br>
									#NEXUS<br><br>

									Begin taxa;<br>
										&nbsp;&nbsp; Dimensions ntax=6;<br>
											&nbsp;&nbsp; &nbsp;&nbsp; Taxlabels<br>
												&nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; horse_1<br>
												&nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; horse_2<br>
												&nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; seahorse_1<br>
												&nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; seahorse_7<br>
												&nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; cat_1<br>
												&nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; catfish_jerry<br>
												&nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp; ;<br>
									End;<br>
									Begin trees;<br>
										&nbsp;&nbsp; Translate<br>
											&nbsp;&nbsp; &nbsp;&nbsp;   1 horse_1,<br>
											&nbsp;&nbsp; &nbsp;&nbsp;    2 horse_2,<br>
											&nbsp;&nbsp; &nbsp;&nbsp;    3 seahorse_1,<br>
											 &nbsp;&nbsp; &nbsp;&nbsp;   4 seahorse_7,<br>
											 &nbsp;&nbsp; &nbsp;&nbsp;   5 cat_1,<br>
											&nbsp;&nbsp; &nbsp;&nbsp;    6 catfish_jerry<br>
									;<br>
									tree STATE_0 = (((((1:0.21108720449043908,2:0.21108720449043908):0.2680638042699739,6:0.479151008760413):0.12515560798169428,5:0.6043066167421073):0.538020168481041,4:1.1423267852231482):0.7086261037474311,3:1.8509528889705793):0.0;
								</div>

								In this example, <span class="code">horse_1</span> and <span class="code">horse_2</span> are mapped to species
								<span class="code">horse</span>, <span class="code">seahorse_1</span> and <span class="code">seahorse_7</span>
								are mapped to <span class="code">seahorse</span>, etc. The use of <span class="code">_</span> delimiters ensures that
								each gene is mapped to exactly 1 species, by preventing  <span class="code">horse_1</span> from being mapped to <span class="code">seahorse</span>.
								<br><br>If UT is unable to find a mapping, consider changing the gene/species labels to something like the above example.




							</div>

						</div>



		


					</div>

				</div>
			</div>
			

			<br><br><br><br><br><br><br><br><br><br><br><br><br><br>


			<!--<div id="footer" style="height:3em">



				
			</div>-->

		</div>

	</body>




</html>
